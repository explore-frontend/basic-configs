# @pex/vite-plugin-chunk

## Why

Vite 默认的打包行为会产出大量小体积的 JS 文件，影响页面加载速度；这个插件可以减少 JS 文件数量

## How

目前提供了两种模式/策略

1. 如果你的应用有一个主要的页面入口，比如大多数人都是从这个页面入口进入你的应用，它的流量占整个应用的 80% 以上，可以优先考虑使用 `single-main` 策略

使用时需要指定你的主页面模块路径，比如：

```js
        chunk('single-main', { mainModule: 'src/views/home/Home.vue' }),
```

这个策略具体的行为是把被主页面引用的模块都打包进一个叫做 `main` 的 chunk，它的副作用是其他页面加载时也会被迫加载 `main` chunk，其中大部分代码可能是无用的；但是由于主页面占流量的大多数，且其他页面很可能是从主页面跳转过去的，所以对整体加载速度的影响依然大概率是正向的，业务项目中的实验结果验证了这个结论

2. 其他情况（比如不符合 `single-main` 的条件或者发现 `single-main` 策略的产物有问题）可以默认选择`loose-common`策略

这个策略具体的行为是对于任何被至少 2 个 entrypoint 引用的模块都会被打包进一个叫做 `common` 的 chunk
